(function(){'use strict';var a=function(a,b){this.initDefaultOptions(),this.extendOptions(b),this.initMenuItems(a),this.getSectionsPositions(),this.bindWindowEvents(),this.bindMenuItems()};a.prototype.initDefaultOptions=function(){this.options={duration:400,activeOffset:40,scrollOffset:10,easingFunction:function(a,e,b,c){return 1>(a/=c/2)?b/2*a*a*a+e:b/2*((a-=2)*a*a+2)+e}}},a.prototype.extendOptions=function(a){if(a)for(var b in this.options)this.options.hasOwnProperty(b)&&a[b]&&(this.options[b]=a[b])},a.prototype.initMenuItems=function(a){this.items=[],!1===Array.isArray(a)&&(a=[a]),a.forEach(function(a){var b=[].slice.call(document.querySelectorAll(a));this.items=this.items.concat(b)}.bind(this))},a.prototype.getTargetOffset=function(a){var b=a.getAttribute("href");return b.match(/^#?$/)?0:document.querySelector(b).offsetTop},a.prototype.bindWindowEvents=function(){window.addEventListener("scroll",this.onWindowUpdate.bind(this),!1),window.addEventListener("resize",this.onWindowUpdate.bind(this),!1)},a.prototype.bindMenuItems=function(){this.items.forEach(function(a){a.addEventListener("click",this.onMenuItemClick.bind(this),!1)}.bind(this))},a.prototype.onWindowUpdate=function(){this.getSectionsPositions(),this.updateActiveMenuItem()},a.prototype.getSectionsPositions=function(){this.positions=this.items.map(function(a){return this.getTargetOffset(a)-this.options.activeOffset}.bind(this))},a.prototype.updateActiveMenuItem=function(){if(this.getScrollOffset()+window.innerHeight===document.body.clientHeight)this.changeActiveMenuItem(this.items[this.items.length-1]);else{var a=this.items.filter(function(a,b){return this.positions[b]<=this.getScrollOffset()}.bind(this));0<a.length?this.changeActiveMenuItem(a[a.length-1]):this.resetActiveMenuItem()}},a.prototype.getScrollOffset=function(){return document.body.scrollTop||window.pageYOffset},a.prototype.resetActiveMenuItem=function(){this.items.forEach(function(a){a.classList.remove("active")})},a.prototype.changeActiveMenuItem=function(a){a.classList.contains("active")||(this.resetActiveMenuItem(),a.classList.add("active"))},a.prototype.onMenuItemClick=function(a){a.preventDefault();var b=this.items.indexOf(a.target);-1===b||(this.updateLocationHash(b),this.animatePageScroll(b))},a.prototype.updateLocationHash=function(a){var b=this.items[a].getAttribute("href"),c=location.pathname+location.search;b.match(/^#?$/)||(c+=b),history.pushState(b,document.title,c)},a.prototype.animatePageScroll=function(a){var b=-this.options.activeOffset+this.options.scrollOffset,c=this.positions[a]-b;this.scrollTo(c,this.options.duration)},a.prototype.scrollTo=function(a,b,c){if(!(0>=b)){var d=a-this.getScrollOffset();c=(c||0)+10,setTimeout(function(){var e=this.options.easingFunction(c,this.getScrollOffset(),d,b);window.scroll(0,e),b===c?this.updateActiveMenuItem():this.scrollTo(a,b,c)}.bind(this),10)}},window.ScrollMenu=a})();